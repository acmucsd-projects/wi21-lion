<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: article/CourseArticle.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: article/CourseArticle.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useEffect, useState, useCallback } from 'react';

import './Article.css';

import banner from './icons/ded 1.jpg';
import PathItem from './PathItem';
import PathDropdownMenu from './PathDropdownMenu';

import dummyArticles from './dummyArticle.json';

/**
 * Called when article type is changed
 */
function updateSelectedArticleType(element) {
    if(element.type === "Orgs"){
        window.location = `/orgs`;
    } else {
        window.location = `/courses`;
    }
}

    /**
     * Called when a new course is selected. Current URL is updated accordingly 
     * @param {*} element 
     */
    function updateSelectedCourse(element) {
        window.location = `/courses/${element.department}/${element.name}`;
    }
/**
 * General course article template.
 *  
 * @param {*} props 
 */
function CourseArticle(props) {

    const { section, course } = props;
    const [departmentList, setDepartmentList] = useState([]);
    const [selectedQuarter, setSelectedQuarter] = useState(null);
    const [quarterList, setQuarterList] = useState([]);
    const [selectedQuarterName, setSelectedQuarterName] = useState("Select a quarter...");
    const [selectedSectionName, setSelectedSectionName] = useState("Select a section...");
    const [sectionList, setSectionList] = useState([]);






    /**
     * Called when department is changed
     */
    function updateSelectedDepartment() {

    }


    /**
     * Update the currently selected quarter 
     * @param {*} element 
     */
    function updateSelectedQuarter(element) {
        const quarter = element.quarter
        if(quarter) {
            setSelectedQuarter(quarter);
            setSelectedQuarterName(quarter)
        }
    }

    function updateSelectedSection(sectionParam) {
        window.location = `/courses/${course.department}/${course.name}/${sectionParam.season}${sectionParam.year}/${sectionParam.letter}`;
    }

    const compareQuarters = useCallback((quarter1, quarter2) => {
        const quarter1Arry = quarter1.split(" ");
        const year1 = quarter1Arry[1];
        const quarter2Arry = quarter2.split(" ");
        const year2 = quarter2Arry[1];

        if(year1 > year2) {
            return 1;
        } else if(year1 &lt; year2) {
            return -1;
        } 

        const season1 = quarter1Arry[0];
        const season2 = quarter2Arry[0];

        const season1Val = getSeasonVal(season1);
        const season2Val = getSeasonVal(season2);
        if(season1Val > season2Val) {
            return 1;
        } else {
            return -1;
        }
    },[])

    function getSeasonVal(season) {
        switch (season) {
            case "Winter":
                return 1;
       
            case "Spring":
                return 2;

            case "Fall":
                return 3;

            default:
                return 0
        }
    }

    /**
     * Retrieves an array of quarters available for the current course
     */
    const getListOfQuarters = useCallback(() => {
        let quarters = [];
        let quarterObjs = [];
        for (let index = 0; index &lt; course.sections.length; index++) {
            const tmpSection = course.sections[index];
            if (Object.hasOwnProperty.call(tmpSection, "season") &amp;&amp; Object.hasOwnProperty.call(tmpSection, "year")) {
                const season = tmpSection["season"];
                const year = tmpSection["year"];
                const quarter = `${season} ${year}`
                if (!quarters.includes(quarter)) {
                    quarters.push(quarter)
                }
            }
        }
        for (let index = 0; index &lt; quarters.length; index++) {
            const element = quarters[index];
            quarterObjs.push({ "quarter": element });
        }
        let i, key, j;
        for(i = 1; i &lt; quarterObjs.length; i++) {
            key = quarterObjs[i].quarter;
            j = i -1;

            while(j>=0 &amp;&amp; compareQuarters(quarterObjs[j].quarter, key)) {
                quarterObjs[j + 1].quarter = quarterObjs[j].quarter;
                j = j -1;
            }
            quarterObjs[j + 1].quarter = key;
        }

        return quarterObjs;
    }, [course.sections, compareQuarters]);

    /**
     * Retrives the available sections for the current course and a given quarter 
     * @param {string} quarter quarter string used to search for sections
     */
    const getListOfSections = useCallback((quarter) => {
        let sections = [];


        course.sections.forEach(element => {
            const sectionQuarter = `${element.season} ${element.year}`
            if (sectionQuarter === quarter) {
                sections.push(element)
            }
        });
        return sections;
    }, [course.sections]);

    /**
     * Adds a formatted section key value pair to each section object. This new value is used
     * for each entry in the section selection dropdown
     */
    const formatSectionList = useCallback(() => {
        let formattedSections = [];

        sectionList.forEach(element => {
            element.formattedVersion = `${element.professor} ${element.letter}`;
            formattedSections.push(element);
        })
        return formattedSections;
    }, [sectionList])


    useEffect(() => {
        setQuarterList(getListOfQuarters());
    }, [course, getListOfQuarters]);

    useEffect(() => {
        if (selectedQuarter) {
            setSectionList(getListOfSections(selectedQuarter));
            updateSelectedQuarter(selectedQuarter);
            if(section &amp;&amp; selectedQuarter !== `${section.season} ${section.year}`) {
                setSelectedSectionName("Select a Section ...");
            }
        }
    }, [selectedQuarter, section, getListOfSections]);

    useEffect(() => {
        if (!section) {
            setSelectedSectionName("Select a section ...");
        } else {
            setSelectedSectionName(section.professor);
            setSelectedQuarter(`${section.season} ${section.year}`);
            setSelectedQuarterName(`${section.season} ${section.year}`);
            setQuarterList(getListOfQuarters());
            // setSectionList(getListOfSections(selectedQuarter));
        }
    }, [section, getListOfQuarters, getListOfSections]);

    useEffect(() => {
        formatSectionList();
    }, [sectionList, formatSectionList]);

    useEffect(() => {
        let departments = [];
        dummyArticles.forEach(element => {
            const department = element["department"];
            if(!departments.includes(department)) {
                departments.push(department);
            }
        });
        let departmentsObjs = [];
        departments.forEach(element => {
            const obj = {"department": element};
            departmentsObjs.push(obj);
        })
        setDepartmentList(departmentsObjs);
    }, []);

    // if(!course) {
    //     return (
    //     &lt;div id="article">
    //         &lt;img className="article-banner" src={banner} alt={course.name + " banner"}>&lt;/img>
    //         &lt;div className="article-header">
    //             &lt;ul className="article-path">
    //                 &lt;PathItem name="Courses">
    //                     &lt;PathDropdownMenu
    //                         list={[{ "type": "Courses" }, { "type": "Orgs" }]}
    //                         type={"type"}
    //                         updateSelection={updateSelectedArticleType}
    //                         selectedItem={"Courses"} />
    //                 &lt;/PathItem>
    //                 &lt;PathItem name={"Select a department ..."}>
    //                     &lt;PathDropdownMenu
    //                         list={departmentList}
    //                         type={"department"}
    //                         updateSelection={updateSelectedDepartment}
    //                         selectedItem={""} />
    //                 &lt;/PathItem>
    //             &lt;/ul>
    //         &lt;/div>
    //         &lt;h3 className="article-body">Select a Course from the dropdown, search bar or navbar.&lt;/h3>
    //     &lt;/div>
    //     )
    // }

    //TODO: make the banner/header its own component
    return (
        &lt;div id="article">
            &lt;img className="article-banner" src={banner} alt={course.name + " banner"}>&lt;/img>
            &lt;div className="article-header">
                &lt;ul className="article-path">
                    &lt;PathItem name="Courses">
                        &lt;PathDropdownMenu
                            list={[{ "type": "Courses" }, { "type": "Orgs" }]}
                            type={"type"}
                            updateSelection={updateSelectedArticleType}
                            selectedItem={"Courses"} />
                    &lt;/PathItem>
                    &lt;PathItem name={course.department}>
                        &lt;PathDropdownMenu
                            list={departmentList}
                            type={"department"}
                            updateSelection={updateSelectedDepartment}
                            selectedItem={course.department} />
                    &lt;/PathItem>
                    &lt;PathItem name={course.name}>
                        &lt;PathDropdownMenu
                            list={dummyArticles}
                            type={"name"}
                            updateSelection={updateSelectedCourse}
                            selectedItem={course.name} />
                    &lt;/PathItem>
                    &lt;PathItem name={selectedQuarterName}>
                        &lt;PathDropdownMenu
                            list={quarterList}
                            type={"quarter"}
                            updateSelection={updateSelectedQuarter}
                            selectedItem={selectedQuarterName} />
                    &lt;/PathItem>
                    {selectedQuarter &amp;&amp;
                        &lt;PathItem name={selectedSectionName}>
                            &lt;PathDropdownMenu
                                list={sectionList}
                                type={"formattedVersion"}
                                updateSelection={updateSelectedSection}
                                selectedItem={selectedSectionName} />
                        &lt;/PathItem>
                    }
                &lt;/ul>
            &lt;/div>
            {props.children}
        &lt;/div>
    );
}

export default CourseArticle 


export function BlankCourse() {

    const [departmentList, setDepartmentList] = useState([]);
    const [selectedDepartment, setSelectedDepartment] = useState()
    const [selectedDepartmentName, setSelectedDepartmentName] = useState("Select a department...")
    // /**
    //  * Called when article type is changed
    //  */
    // function updateSelectedArticleType(element) {
    //     if(element.type === "Orgs"){
    //         window.location = `/orgs`
    //     }
    // }

    /**
     * Called when department is changed
     */
    function updateSelectedDepartment(element) {
        setSelectedDepartment(element.department)
        setSelectedDepartmentName(element.department)
    }

    useEffect(() => {
        let departments = [];
        dummyArticles.forEach(element => {
            const department = element["department"];
            if(!departments.includes(department)) {
                departments.push(department);
            }
        });
        let departmentsObjs = [];
        departments.forEach(element => {
            const obj = {"department": element};
            departmentsObjs.push(obj);
        })
        setDepartmentList(departmentsObjs);
    }, []);

    return (
        &lt;div id="article">
            &lt;img className="article-banner" src={banner} alt={"banner"}>&lt;/img>
            &lt;div className="article-header">
                &lt;ul className="article-path">
                    &lt;PathItem name="Courses">
                        &lt;PathDropdownMenu
                            list={[{ "type": "Courses" }, { "type": "Orgs" }]}
                            type={"type"}
                            updateSelection={updateSelectedArticleType}
                            selectedItem={"Courses"} />
                    &lt;/PathItem>
                    &lt;PathItem name={selectedDepartmentName}>
                        &lt;PathDropdownMenu
                            list={departmentList}
                            type={"department"}
                            updateSelection={updateSelectedDepartment}
                            selectedItem={selectedDepartment} />
                    &lt;/PathItem>
                    {selectedDepartment &amp;&amp; &lt;PathItem name={"Select a course ..."}>
                        &lt;PathDropdownMenu
                            list={dummyArticles}
                            type={"name"}
                            updateSelection={updateSelectedCourse}
                            selectedItem={""} />
                    &lt;/PathItem>}
                &lt;/ul>
            &lt;/div>
            &lt;h3 className="article-body">Select a department and a course from the dropdown, search bar or navbar.&lt;/h3>
        &lt;/div>
    );
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#CourseArticle">CourseArticle</a></li><li><a href="global.html#LinkEntry">LinkEntry</a></li><li><a href="global.html#LinksPanel">LinksPanel</a></li><li><a href="global.html#OrgArticle">OrgArticle</a></li><li><a href="global.html#PathItem">PathItem</a></li><li><a href="global.html#querySearch">querySearch</a></li><li><a href="global.html#SectionContent">SectionContent</a></li><li><a href="global.html#updateSelectedArticleType">updateSelectedArticleType</a></li><li><a href="global.html#updateSelectedCourse">updateSelectedCourse</a></li><li><a href="global.html#useOutsideAlerter">useOutsideAlerter</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Tue Mar 23 2021 03:37:33 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
